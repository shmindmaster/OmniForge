<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900">
  <defs>
    <style type="text/css"><![CDATA[
      .box { fill:#ffffff; stroke:#2c3e50; stroke-width:2; rx:10; ry:10; }
      .title { font-family: Arial, Helvetica, sans-serif; font-size:20px; fill:#2c3e50; font-weight:bold; }
      .subtitle { font-family: Arial, Helvetica, sans-serif; font-size:16px; fill:#2c3e50; }
      .muted { font-family: Arial, Helvetica, sans-serif; font-size:14px; fill:#7f8c8d; }
      .arrow { stroke:#3498db; stroke-width:3; marker-end:url(#arrowhead); fill:none; }
      .group { fill:#ecf0f1; stroke:#bdc3c7; stroke-dasharray:6 6; }
      .label { font-family: Arial, Helvetica, sans-serif; font-size:14px; fill:#2c3e50; }
    ]]></style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="800" y="50" text-anchor="middle" class="title">im2fit — System Architecture</text>
  <text x="800" y="80" text-anchor="middle" class="muted">Upload → Segmentation → Scale (mm) → Metrics/Overlay/STL → Azure Blob</text>

  <!-- Client -->
  <rect x="60" y="180" width="220" height="110" class="box"/>
  <text x="170" y="220" text-anchor="middle" class="title">Client</text>
  <text x="170" y="245" text-anchor="middle" class="subtitle">Web UI / Swagger</text>

  <!-- FastAPI App Service group -->
  <rect x="340" y="120" width="520" height="360" class="group"/>
  <text x="600" y="145" text-anchor="middle" class="muted">Azure App Service (Container)</text>

  <!-- FastAPI -->
  <rect x="370" y="180" width="220" height="110" class="box"/>
  <text x="480" y="215" text-anchor="middle" class="title">FastAPI</text>
  <text x="480" y="240" text-anchor="middle" class="subtitle">/process, /version, /health</text>

  <!-- Segmentation -->
  <rect x="640" y="180" width="200" height="110" class="box"/>
  <text x="740" y="210" text-anchor="middle" class="title">Segmentation</text>
  <text x="740" y="235" text-anchor="middle" class="subtitle">ONNX (YOLOv11)</text>
  <text x="740" y="257" text-anchor="middle" class="muted">or Hosted (Roboflow)</text>

  <!-- Scaling -->
  <rect x="370" y="300" width="220" height="110" class="box"/>
  <text x="480" y="335" text-anchor="middle" class="title">Scaling</text>
  <text x="480" y="360" text-anchor="middle" class="subtitle">ArUco 20 mm → mm/px</text>

  <!-- Metrics & Artifacts -->
  <rect x="640" y="300" width="200" height="110" class="box"/>
  <text x="740" y="330" text-anchor="middle" class="title">Metrics & Artifacts</text>
  <text x="740" y="355" text-anchor="middle" class="subtitle">Overlay PNG, CSV, STL</text>

  <!-- Blob Storage Group -->
  <rect x="960" y="160" width="260" height="320" class="group"/>
  <text x="1090" y="185" text-anchor="middle" class="muted">Azure Storage</text>

  <!-- Blob Container -->
  <rect x="990" y="220" width="200" height="110" class="box"/>
  <text x="1090" y="255" text-anchor="middle" class="title">Blob Container</text>
  <text x="1090" y="280" text-anchor="middle" class="subtitle">Artifacts (public/private)</text>

  <!-- Delivery -->
  <rect x="990" y="340" width="200" height="110" class="box"/>
  <text x="1090" y="373" text-anchor="middle" class="title">Delivery</text>
  <text x="1090" y="397" text-anchor="middle" class="subtitle">Direct URLs / Proxy</text>
  <text x="1090" y="418" text-anchor="middle" class="muted">SAS (signed) recommended</text>

  <!-- Optional Proxy -->
  <rect x="1260" y="300" width="260" height="130" class="group"/>
  <text x="1390" y="325" text-anchor="middle" class="muted">Optional</text>
  <rect x="1290" y="340" width="200" height="70" class="box"/>
  <text x="1390" y="372" text-anchor="middle" class="title">/artifact/{name}</text>
  <text x="1390" y="394" text-anchor="middle" class="muted">PUBLIC_ARTIFACT_PROXY=1</text>

  <!-- Arrows -->
  <path d="M 280 235 L 370 235" class="arrow"/>
  <path d="M 590 235 L 640 235" class="arrow"/>
  <path d="M 740 290 L 740 300" class="arrow"/>
  <path d="M 480 290 L 480 300" class="arrow"/>
  <path d="M 840 355 L 990 275" class="arrow"/>
  <path d="M 840 355 L 990 395" class="arrow"/>
  <path d="M 1190 375 L 1290 375" class="arrow"/>
  <path d="M 1190 275 L 1290 375" class="arrow"/>

  <!-- Notes -->
  <text x="800" y="820" text-anchor="middle" class="muted">Managed Identity + RBAC recommended for Storage access; connection string supported for demos.</text>
</svg>
