<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>im2fit Demo - Nail Segmentation</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <div class="container">
        <h1>im2fit Demo</h1>
        <p>Upload → mm Measures → Overlay → STL</p>
        
        <div class="upload-section">
            <div class="upload-area" id="dropArea">
                <div class="upload-content">
                    <p>Drag & Drop image here</p>
                    <span>or</span>
                    <label for="fileInput" class="file-button">Choose File</label>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;">
                </div>
            </div>
            <button id="processBtn" class="process-btn" disabled>Process</button>
            <p class="tip">
                Tip: include 20mm ArUco marker — 
                <a href="/static/markers/aruco_20mm.png" download>download link</a>
            </p>
        </div>

        <div class="status-section">
            <div class="status">
                <span id="statusText">Ready</span>
                <div class="spinner" id="spinner" style="display: none;"></div>
            </div>
            <div class="confidence">
                Scale Confidence: <span id="confidenceValue">-</span>
            </div>
        </div>

        <div class="results-section" id="resultsSection" style="display: none;">
            <div class="preview-section">
                <h3>Overlay Preview</h3>
                <img id="overlayPreview" alt="Processed overlay" style="max-width: 100%; height: auto;">
            </div>
            
            <div class="metrics-section">
                <h3>Metrics</h3>
                <table id="metricsTable">
                    <tr><td>Length (mm):</td><td id="lengthMm">-</td></tr>
                    <tr><td>Width Prox (mm):</td><td id="widthProxMm">-</td></tr>
                    <tr><td>Width Mid (mm):</td><td id="widthMidMm">-</td></tr>
                    <tr><td>Width Dist (mm):</td><td id="widthDistMm">-</td></tr>
                    <tr><td>mm/px:</td><td id="mmPerPx">-</td></tr>
                    <tr><td>Sharpness:</td><td id="sharpness">-</td></tr>
                    <tr><td>Mask Area (px):</td><td id="maskArea">-</td></tr>
                </table>
            </div>
        </div>

        <div class="artifacts-section" id="artifactsSection" style="display: none;">
            <h3>Artifacts</h3>
            <div class="artifact-links">
                <a id="csvLink" href="#" download class="artifact-btn">Download CSV</a>
                <a id="stlLink" href="#" download class="artifact-btn">Download STL</a>
            </div>
            
            <div class="viewer-section">
                <h3>3D Viewer (STL)</h3>
                <canvas id="stlViewer" width="400" height="300"></canvas>
            </div>
        </div>

        <div class="docs-link">
            <a href="/docs">Swagger Docs</a>
        </div>
    </div>

    <script src="/static/js/three.min.js"></script>
    <script src="/static/js/STLLoader.js"></script>
    <script src="/static/js/OrbitControls.js"></script>
    <script src="/static/js/ui.js"></script>
</body>
</html>